---
# Example from https://joss.readthedocs.io/en/latest/submitting.html
title: 'MDBED: An R package for simulating the Moran-Downton bivariate exponential
  distribution'
tags:
  - R
  - Bivarite probability distributions
  - Moran-Downton bivariate exponential distribution
  - Hydrology
  - Reliability
  - Queueing systems
  
authors:
  - name: Luis F. Duque
    orcid: 0000-0002-0367-8496
    affiliation: 1
affiliations:
 - name: School of Engineering, Newcastle University, Newcastle Upon Tyne NE1 7RU,
    UK
   index: 1
citation_author: Duque.
date: 9 March 2020
year: 2020
bibliography: paper.bib
output: rticles::joss_article
csl: apa.csl
journal: JOSS
---

# Summary

A bivariate exponential distribution (BED), the Moran-Downton bivariate exponential distribution (MDBED) to be specific, has been widely applied in several fields such as reliability, queueing systems, or hydrology. In the latter, it has been mainly used to simulate the bivariate relationship between the discharge exceedances and their durations [@Choulakian1990] or the intensity and duration of a storm of rainfall [@Cordova1985]. @Nagao1971 further claimed that this bivariate distribution could be used to represent the joint behaviour of the exceedances of flow discharges at two points on a river or rainfall at two locations.

The bivariate modelling of the BED can be addressed by using a 'copula' [@Nelsen2006], and the R package copula [@Yan2007] provides a carefully designed and easily extensible platform for that purpose. However, this tool does not offer an option to describe/analyse the conditional properties of the bivariate distribution to be analysed. To the best of my knowledge, there is not a statistical free software that describes the BED fully. The ``MDBED`` package is an R package that meets this aim by using a parametric approach based on the equations of the Moran-Downton model [@Downton1970].  Through a set of functions, this package provides values of the joint and conditional probability density functions (PDFs) and cumulative distribution functions (CDFs), builds 3D plots of this bivariate distribution, and generates bivariate random values.

The ``dBED`` and ``pBED`` functions provide the values of $f(x,y)$ and $F(x,y)$ of the BED for positive pairs ($x,y$) respectively. The required inputs are the correlation coefficient between the marginal distributions of $x$ and $y$ ($\rho_{xy}$), the scale parameter of the marginal distribution of $x$ ($\beta_x$), the scale parameter of the marginal distribution of $y$ ($\beta_y$), and the pairs ($x,y$). The values of $f(x,y)$ and $F(x,y)$ are computed based on Eqs.18 and 10.54 described in @Nagao1971 and @Balakrishna2009 respectively.

The functions ``PDF_3dPlot`` and ``CDF_3dPlot`` build a 3D plot of $f(x,y)$ and $F(x,y)$ respectively. The main required inputs for these functions are $\rho_{xy}$, $\beta_x$, and $\beta_y$. Figure 1 shows an example of the output of the former function. This package also has the function ``Countour_Plot`` that builds the contour plot of the BED. The main required inputs are $\rho_{xy}$, $\beta_x$, $\beta_y$, and the values of $F(x,y)$ associated to the contours. This function also allows pairs of values to be plotted on the contour plot.

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Output of the ``PDF_3dPlot`` function of the ``MDBED`` R package. Adopted parameters: $\\rho_{xy}$=0.85, $\\beta_x$=1, $\\beta_y$=1"}
library(MDBED)
par(mar = c(.75, .75, .75, .75))
PDF_3dPlot(rho=0.85, Betax=1, Betay=1, GS=0.1)
```

```{r echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Figure to illustrate the description of the conditional properties of the BED through the MDBED package. a) $n$ pairs ($x,y$) generated by using the ``rBED`` function, b) and c) conditional PDF and CDF of one the values of $x$ shown in c)(red point). The values of the conditional PDF and CDF can be obtained through the ``CondBED`` function. Adopted parameters for this example: $\\rho_{xy}$=0.85, $\\beta_x$=1, $\\beta_y$=1, $n$=50"}
library(MDBED)
Data<-rBED(n=50,Betax=1,Betay=1,rho=0.85)
Conyx<-CondBED(rho=0.85,Betax=1,Betay=1,x=Data[,1])

library(ggplot2)
# plot of jointly exponential random values 

Data$Color<-"Black"
Data$Color[25]<-"Red"
Pjerv<-ggplot(Data, aes(x=x,y=y, color=Color, size=Color))+
  theme_bw()+
  geom_point()+
  scale_color_manual(values = c("Black" = "black", "Red" = "red"))+
  scale_size_manual(values = c("Black" = 1.5, "Red" = 3))+
  labs(x=expression(italic(x)),y=expression(italic(y)))+
  theme(legend.position = "none") 

# plot conditional PDF and PDF for the pair 25
df_25<-Conyx$Condyx$`ConDs_ 25`
PDF_25<-ggplot(df_25,aes(x=yc,y=fyx))+
  theme_bw()+
  geom_line()+
  labs(x=expression(italic(y[c])),y=expression(italic(f(YlX==x))))

# plot conditional CDF and PDF for the pair 25
CDF_25<-ggplot(df_25,aes(x=yc,y=Fyx))+
  theme_bw()+
  geom_line()+
  labs(x=expression(italic(y[c])),y=expression(italic(F(YlX==x))))

library(ggpubr)
ggarrange(Pjerv,PDF_25,CDF_25,labels = c("a","b","c"), ncol = 3,nrow = 1)
```

The ``MDBED`` package through the ``CondBED`` function also describes the conditional PDF and CDF of $Y$ given $X=x$, i.e., $f(Y \mid X=x)$ and $F(Y \mid X=x)$ respectively.  The required inputs are $\rho_{xy}$, $\beta_x$, $\beta_y$, and a value or vector of values of the marginal distribution of $x$. $f(Y \mid X=x)$ is defined by using the conditional moments, i.e., the conditional mean $E(Y \mid X=x)$ and variance $var(Y \mid X=x)$,  of the Moran-Downton model described in Eqs. 21 and 22 in @Nagao1971. $F(Y \mid X=x)$ is computed via numerical integration of $f(Y \mid X=x)$ by using the Riemann sum method [@Hughes-Hallett2008]. This function returns a list with a dataframe named Conditional_Statistics and a sublist named Condyx. Conditional_Statistics contains the values of $x$ with its conditional moments, and Condyx contains several dataframes with the information of the conditional distributions associated with each value of $x$. For each conditional distribution, the values of the conditional quantiles ($y_c$) with its respective values of $f(Y \mid X=x)$ and $F(Y \mid X=x)$ are provided. The first dataframe of Condyx corresponds to the first value of $x$ shown in Conditional_Statistics; the second dataframe corresponds to the second value of $x$ shown in Conditional_Statistics, and so on. 

This package also has a bivariate generator; the ``rBED`` function. The required inputs are $\rho_{xy}$, $\beta_x$, $\beta_y$, and the $n$ number of bivariate random values to be generated. This function generates jointly exponential random values based on the conditional approach [@Lewis2017]. Thus, It first generates $n$ random values of $X$; then, the conditional moments $E(Y \mid X=x)$ and $var(Y \mid X=x)$ associated with each value of $x$ are computed to define $F(Y \mid X=x)$ . Finally, the random values of $Y$ are obtained by drawing a random value from each $F(Y \mid X=x)$. This function returns a dataframe with the $n$ pairs ($x,y$) generated. 

Figure 2 illustrates how the ``MDBED`` package can be used to explore the conditional properties of the BED. Figure 2a shows $n$ pairs ($x,y$) generated through the ``rBED`` function, and Figure 2b and 2c show the conditional PDF and CDF, obtained by using the ``CondBED`` function, of one of these $x$ values (red point). This package is available on GitHub under the GNU General Public License at https://github.com/lfduquey/MDBED and on the Comprehensive R Archive Network (CRAN) at https://cran.r-project.org/web/packages/MDBED/index.html.

# References
